# 工作笔记

# 2022/12/02 - 2022/12/02 通用版本更新
- [x]新增 APP_TASK_RESULT_ASYNC_SAVE_WITH_SYNC 环境变量，详见文档

# 2022/11/26-2022/11/29 通用版本更新
- [x]更新Excel转PDF依赖库版本，解决Excel转PDF时，宽度超出页宽时，超出部分会被分割到下一页的问题

## 2022/11/21 - 2022/11/22 柳州银行与北部湾银行定制化更新
- [x]集成cas单点登录功能

## 2022/11/18 通用版本更新
- [x]新增识别耗时DB记录
- [x]新增任务超出最大识别重试次数的逻辑处理


## 2022/11/11-2022/11-12 通用版本更新
- [x]财报科目推理引擎上线到公有云
- [x]财报上线到公有云：https://www.textin.com/for_financial_statements/user/login
- [x]财报公有云持续集成：https://gitlab.intsig.net/acg_sre/textin-financial-statement

## 2022/11/07-2022/11/08 通用版本更新
### 
- [x]完成达梦数据库适配工作
- [x]优化部署脚本，输入配置项时，系统支持默认值

## 2022/11/03-2022/11/03 兴业银行-私有化-仅部署-莫春艳

## 2022/10/31-2022/11/02 柳州银行-私有云定制
### 定制化功能
- [x]新增历史文件备份功能，指定目录将要删除的历史文件备份过去，指定数据库将要删除的历史文件备份过去
- [x]新增token第三方授权登录功能

## 2022/10/27 财报NLP提取引擎优化沟通
### 内容
财报的科目匹配原逻辑使用两个文本之间的最小编辑据里来匹配最佳科目，但带来的问题就是，如果有个科目较做“应收金额”，OCR识别到的文本“应付金额”，这两个文本虽然最小编辑据里得出的相似度非常高，但语义却截然不同。所以需要算法团队提供两个文本之间相似度匹配的算法供财报使用，已于算法团队沟通，大概2022/11/09日之前提供成品引擎。

## 2022/10/27 德勤-私有云部署
### 部署v4版本财报

## 2022/10/10-2022/10/27 杭州泰隆银行-私有云定制
### 定制化功能
#### 创建任务：
- [x] 新增渠道信息字段,只做记录
- [x] 文件信息新增外部文件id信息
- [x] 文件列表里的首个文件id当作任务名

返回参数：
- [x] 外部文件id
- [x] 财报识别结果json，新增科目id对应的科目名称

#### 【通用】磁盘清理：
- [x] 删除1月之前任务的文件
- [x] 1月之前的任务查看时提示：“任务已过期（已删除）”


#### Web后台管理界面
- [x] 审核员只允许访问财报结果查看审核界面（web url参数携带4A token供4A权限认证）
- [x] 其他界面无需对接4A系统，直接使用财报账号体系，财报账号支持一个账号多人同时使用
- [x] 所有web界面去除任何有关合合的UI元素（包括web page title信息）

#### 审核界面4A认证流程：
* 审核员点击“查看识别结果”链接（4A token + 任务id）
* 财报拿到token 去 java层验证有效性以及获取token用户信息，保存时无需再校验token时效性。

#### 【通用】任务识别结果回调
- [x] 识别完成后通过行方提供的url进行接口回调，回调时除了整个任务的识别状态外，还需要返回每个文件的识别状态

#### 【通用】定时任务
- [x] 增加历史任务清理定时任务

#### 【通用】系统功能
- [x] 增加是否为公有云Saas服务的配置，如果是公有云，在创建任务、查看任务识别结果时，不进行权限验证
